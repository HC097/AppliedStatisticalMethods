---
title: "assignment4"
author: "Harley Combest"
date: "`r Sys.Date()`"
output: 
    html_document:
      toc: yes
      toc_float: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# 10/10

## Question 1 (MS 7.118 - pg 364)

### a.

```{r}
birds=read.csv("NZBIRDS.csv")
set.seed(1)
sam1 <- sample(1 : 116, size = 35, replace = F)
sam1
```

### b.

```{r}
meanBodMas=mean(birds$Body.Mass[sam1])
meanBodMas

sdBodMas=sd(birds$Body.Mass[sam1])
sdBodMas

n=35
alpha=.05
sterrBodMas=sdBodMas/sqrt(n)
dfBodMas=n-1
tBodMas=qt(p=alpha/2, df=dfBodMas,lower.tail=F)

merrBodMas=tBodMas*sterrBodMas

lwrBound <- meanBodMas - merrBodMas
upprBound <- meanBodMas + merrBodMas

print(c(lwrBound,upprBound))
```

### c. We can say with 95% certainty that the mean value of body mass for the birds is between 358.4222 and 1261.5206.

### d. It's very likely to contain mu as 95% of the interval is contained within this confidence interval.

### e. 

```{r}
set.seed(2)
sam2 <- sample(1 : 116, size = 35, replace = F)
sam2
```

```{r}
meanEgg=mean(birds$Egg.Length[sam2])
meanEgg

sdEgg=sd(birds$Egg.Length[sam2])
sdEgg

n=35
alpha=.05
sterrEgg=sdEgg/sqrt(n)
dfEgg=n-1
tEgg=qt(p=alpha/2, df=dfEgg,lower.tail=F)

merrEgg=tEgg*sterrEgg

lwrBound1 <- meanEgg - merrEgg
upprBound1 <- meanEgg + merrEgg

print(c(lwrBound1,upprBound1))
```

We can say with 95% certainty that the mean length of eggs for the birds is between 40.14945 and 55.50769.

It's very likely to contain mu as 95% of the interval is contained within this confidence interval.

### f.

```{r}
p1=21/38
q1=1-p1
n1=38
p2=7/78
q2=1-p2
n2=78

alpha=0.05
z=qnorm(1-(alpha)/2, 0, 1)

lwrBound2=(p1-p2)- z*(sqrt((p1*q1)/n1 +(p2*q2)/n2))
upprBound2=p1-p2+z*sqrt((p1*q1)/n1 +(p2*q2)/n2)

print(c(lwrBound2,upprBound2))
```

### g.

The confidence interval does not contain 0 and numbers are all positive in the interval. This means that the proportion of flightless birds should be greater for extinct than non-extinct species.

This supports the theory.

## Question 2 (MS 7.120 - pg 365)

### a.

```{r}
ybar1=1312
sSq1=(422)^2
n1=100

ybar2=1352
sSq2=(271)^2
n2=47

alpha=0.1
z=1.645 #qnorm(1-(alpha)/2, 0, 1)

lwrBound3= (ybar1-ybar2) - z*(sqrt(sSq1/n1 + sSq2/n2))
upprBound3=(ybar1-ybar2) + z*(sqrt(sSq1/n1 + sSq2/n2))

print(c(lwrBound3,upprBound3))
```
### b.

```{r}
v1=n1-1
v2=n2-2

ratio=sSq1/sSq2

F1=qf(1-(alpha)/2, v1, v2)
F2=qf(alpha/2, v1, v2)

lwrBound4=ratio/F1
upprBound4=ratio/F2

print(c(lwrBound4,upprBound4))
```

## Question 3 (MS 7.128 - pg 367)

### a.

Y had a normal distribution with mu=0 and sigma =/= 0.

$$
Z= \frac{Y-\mu}{\sigma}= \frac{Y-0}{\sigma}
$$

has a standard normal distribution.

$$
Z^2=\frac{Y^2}{\sigma^2}
$$

is a chi-squared distribution with 1 degree of freedom by Theorem 6.11.

### b.

$$
P(\chi^2_{1-\frac{\alpha}{2}} \leq \frac{Y^2}{\sigma^2} \leq \chi^2_{\frac{\alpha}{2}})

=1-\alpha\\

=P(\frac{1}{\chi^2_{1-\frac{\alpha}{2}}}\geq \frac{\sigma^2}{Y^2} \geq \frac{1}{\chi^2_{\frac{\alpha}{2}})}\\

=P(\frac{1}{\chi^2_{\frac{\alpha}{2}}} \leq \frac{\sigma^2}{Y^2} \leq \frac{1}{\chi^2_{1-\frac{\alpha}{2}})}\\

=P(\frac{Y^2}{\chi^2_{\frac{\alpha}{2}}} \leq \sigma^2 \leq \frac{Y^2}{\chi^2_{1-\frac{\alpha}{2}}})
$$

## Question 4 (MS 8.24 - pg 390)

### a.

$H_0:\mu=2$
$H_a:\mu\neq2$

### b.

The test statistic is âˆ’1.02 and the p-value is 0.322.

### c.

```{r}
roughpipe=read.csv("ROUGHPIPE.csv")
roughness=roughpipe$ROUGH

df=length(roughness)-1
alpha=0.05

lwrBound5=qt(alpha/2,df)
upprBound5=qt(1-alpha/2,df)

print(c(lwrBound5,upprBound5))
```

Reject all values below -2.093024 and above 2.093024.

### d. 

We accept The Null Hypothesis.

### e.

The test statistic is in between both rejection regions.

## Question 5 (MS 8.28 - pg 392)

### a.

$H_0:\mu=15$
$H_a:\mu\neq15$

```{r}
waLakes <- read.csv("WISCLAKES.csv")
disOx <- waLakes$DOC

t.test(disOx,alpha=.1,mu=15)
```
p-value of .8535 > significance level of .10. We fail to reject the null hypothesis

### b.

We have $t=-.18668$

```{r}
pseudoDisOx=c(14,13,15,13,15)
t.test(pseudoDisOx,alpha=.1,mu=14)
```

Fairly high likelihood that this occurs.

## Question 6 (MS 8.44 - pg 401)

```{r}
orchard=read.csv("ORCHARD.csv")
#head(orchard)

fog=orchard[orchard$CONDITION=="FOG",]
#head(na.omit(fog))
clear=orchard[orchard$CONDITION=="CLEAR",]
#head(clear)

mean(na.omit(fog$RATIO))
mean(na.omit(clear$RATIO))
```

$H_0:\mu_1-\mu_2=0$
$H_a:\mu_1-\mu_2\neq0$

```{r}
t.test(na.omit(fog$RATIO),na.omit(clear$RATIO))
```
p-value of .05589 > significance level of .05. We fail to reject the null hypothesis.

## Question 7 (MS 8.84 - pg 425)

### a. 

```{r}
gasturbine <- read.csv("GASTURBINE.csv")
#gasturbine
library(dplyr)
gasturbine %>% filter(ENGINE == "Traditional" | ENGINE == "Aeroderiv") %>% var.test(HEATRATE ~ ENGINE, data = .)
```

P-value = 0.004234 < significance level = .05. We succeed in rejecting the null hypothesis.

There is sufficient evidence to back this assumption in 8.39.

### b.

```{r}
gasturbine %>% filter(ENGINE == "Advanced" | ENGINE == "Aeroderiv") %>% var.test(HEATRATE ~ ENGINE, data = .)
```

P-value = 1.192e-06 < significance level = .05. We succeed in rejecting the null hypothesis.

There is sufficient evidence to back this assumption in 8.39.

## Question 8 (MS 8.99 - pg 438)

### a.

$H_0:\frac{\sigma_1^2}{\sigma_2^2}=1$
$H_a:\frac{\sigma_1^2}{\sigma_2^2}\neq1$

### b.

```{r}
gobiants=read.csv("GOBIANTS.csv")
stepAnts=gobiants[gobiants$Region=="Dry Steppe",]
desertAnts=gobiants[gobiants$Region=="Gobi Desert",]

gobiants %>% filter(Region == "Dry Steppe" | Region == "Gobi Desert") %>% var.test(AntSpecies ~ Region, data = .)
```

test statistic is F = 1.3684

### c.

```{r}
qf(c(0.05/2,1-0.05/2),length(stepAnts)-1,length(desertAnts)-1)
```

### d.

P-value=0.7264 > significance level=.05. We fail to reject the null hypothesis.

### e. 

We can not reject the idea that the variances of the populations at the two sites must be equal.

### f.

Must be an independent random sample from a normal population.

## Question 9 (MS 8.104 - pg 439)

```{r}
thruput <- read.csv("THRUPUT.csv")
human <- thruput$HUMAN
auto <- thruput$AUTO

t.test(human, auto)
```

## Question 10 (independent question)

```{r}
set.seed(35); sam <- round(rnorm(30,mean=20, sd=3),3)

myboot<-function(iter=10000,x,fun="mean",alpha=0.05,...){  #Notice where the ... is repeated in the code
n=length(x)   #sample size

df=n-1
s=sd(x)
ybar=mean(x)
t_quant=qt(1-alpha/2,df)
L=ybar-(t_quant*s)/(sqrt(n))
U=ybar+(t_quant*s)/(sqrt(n))

y=sample(x,n*iter,replace=TRUE)
rs.mat=matrix(y,nr=n,nc=iter,byrow=TRUE)
xstat=apply(rs.mat,2,fun) # xstat is a vector and will have iter values in it 
ci=quantile(xstat,c(alpha/2,1-alpha/2))# Nice way to form a confidence interval
# A histogram follows
# The object para will contain the parameters used to make the histogram
para=hist(xstat,breaks=9,freq=FALSE,las=1,
main=paste("Histogram of Bootstrap sample statistics","\n","alpha=",alpha," iter=",iter,sep=""),
...)
para

#mat will be a matrix that contains the data, this is done so that I can use apply()
mat=matrix(x,nr=length(x),nc=1,byrow=TRUE)

#pte is the point estimate
#This uses whatever fun is
pte=apply(mat,2,fun)
abline(v=pte,lwd=3,col="Black")# Vertical line
segments(ci[1],0,ci[2],0,lwd=4)      #Make the segment for the ci
text(ci[1],0,paste("(",round(ci[1],2),sep=""),col="Red",cex=3)
text(ci[2],0,paste(round(ci[2],2),")",sep=""),col="Red",cex=3)
text(L,0.15,paste("(",round(L,2),sep=""),col="Blue",cex=3)
text(U,0.15,paste(round(U,2),")",sep=""),col="Blue",cex=3)

# plot the point estimate 1/2 way up the density
text(pte,max(para$density)/2,round(pte,2),cex=3)

return(list(fun=fun,x=x, t=t_quant, ci=ci, cit=unname(ci)))# Some output to use if necessary
}

myboot(10000,x=sam,fun="mean",alpha=0.05,xlab="mean(x)",col=rainbow(9))
```

















